apiVersion: keda.sh/v1alpha1
kind: ScaledObject
metadata:
  name: optimus-worker-rust-retry-scaler
  namespace: optimus
  labels:
    language: rust
spec:
  scaleTargetRef:
    name: optimus-worker-rust  # Target language-specific deployment
  minReplicaCount: 0
  maxReplicaCount: 5
  pollingInterval: 30
  cooldownPeriod: 120
  triggers:
  - type: redis
    metadata:
      # Redis connection
      address: redis:6379
      # Retry queue name for Rust jobs
      listName: optimus:queue:rust:retry
      # Scale up when retry queue has more than 3 items
      listLength: "3"
      # Activate scaling from 0 when there are any retries
      activationListLength: "1"
