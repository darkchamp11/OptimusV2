apiVersion: keda.sh/v1alpha1
kind: ScaledObject
metadata:
  name: optimus-worker-java-retry-scaler
  namespace: optimus
  labels:
    language: java
spec:
  scaleTargetRef:
    name: optimus-worker-java  # Target language-specific deployment
  minReplicaCount: 0
  maxReplicaCount: 5
  pollingInterval: 30
  cooldownPeriod: 120
  triggers:
  - type: redis
    metadata:
      # Redis connection
      address: redis:6379
      # Retry queue name for Java jobs
      listName: optimus:queue:java:retry
      # Scale up when retry queue has more than 3 items
      listLength: "3"
      # Activate scaling from 0 when there are any retries
      activationListLength: "1"
